// Generated by CoffeeScript 1.9.0
(function() {
  var __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    __hasProp = {}.hasOwnProperty;

  define(["backbone", "views/base_view", "text!tpl/game.html", "models/answer", "collections/answer_collection", "models/question", "views/question_view"], function(Backbone, BaseView, template, Answer, AnswerCollection, Question, QuestionView) {
    var GameView;
    GameView = (function(_super) {
      __extends(GameView, _super);

      function GameView() {
        return GameView.__super__.constructor.apply(this, arguments);
      }

      GameView.prototype.template = _.template(template);

      GameView.prototype.tagName = "div";

      GameView.prototype.className = "game";

      GameView.prototype.eventBus = [
        {
          "question:answered": "questionAnswered"
        }
      ];

      GameView.prototype.currentQuestionIndex = 0;

      GameView.prototype.subViews = [];

      GameView.prototype.initialize = function() {
        var answers, q1, q2, q3;
        this.subViews = [];
        this.currentQuestionIndex = 0;
        q1 = new Question({
          text: "Which country is this?",
          answer_id: 2,
          img_src: "assets/img/countries/usa.png"
        });
        answers = new AnswerCollection();
        answers.add(new Answer({
          id: 1,
          text: "Canada",
          question: q1
        }));
        answers.add(new Answer({
          id: 2,
          text: "USA",
          question: q1
        }));
        answers.add(new Answer({
          id: 3,
          text: "Mexico",
          question: q1
        }));
        answers.add(new Answer({
          id: 4,
          text: "England",
          question: q1
        }));
        q1.set("answers", answers);
        q2 = new Question({
          text: "Which country is this?",
          answer_id: 1,
          img_src: "assets/img/countries/mexico.png"
        });
        answers = new AnswerCollection();
        answers.add(new Answer({
          id: 1,
          text: "Mexico",
          question: q2
        }));
        answers.add(new Answer({
          id: 2,
          text: "El Salvador",
          question: q2
        }));
        answers.add(new Answer({
          id: 3,
          text: "USA",
          question: q2
        }));
        answers.add(new Answer({
          id: 4,
          text: "Honduras",
          question: q2
        }));
        q2.set("answers", answers);
        q3 = new Question({
          text: "Which country is this?",
          answer_id: 3,
          img_src: "assets/img/countries/canada.png"
        });
        answers = new AnswerCollection();
        answers.add(new Answer({
          id: 1,
          text: "USA",
          question: q3
        }));
        answers.add(new Answer({
          id: 2,
          text: "Greenland",
          question: q3
        }));
        answers.add(new Answer({
          id: 3,
          text: "Canada",
          question: q3
        }));
        answers.add(new Answer({
          id: 4,
          text: "Iceland",
          question: q3
        }));
        q3.set("answers", answers);
        return this.questions = [q1, q2, q3];
      };

      GameView.prototype.render = function() {
        this.$el.html(this.template());
        this.renderNextQuestion(0);
        return this;
      };

      GameView.prototype.renderNextQuestion = function(questionIndex) {
        var question;
        this.currentQuestionIndex = questionIndex;
        question = this.questions[questionIndex];
        if (question != null) {
          if (this.questionView != null) {
            this.questionView.remove();
          }
          this.questionView = new QuestionView({
            question: question
          });
          this.subViews.push(this.questionView);
          return this.$el.find(".question-container").html(this.questionView.render().el);
        } else {
          return alert("All Done!");
        }
      };

      GameView.prototype.questionAnswered = function(correct) {
        return this.renderNextQuestion(this.currentQuestionIndex + 1);
      };

      return GameView;

    })(BaseView);
    return GameView;
  });

}).call(this);
